# Heimdall Admin Service Environment Configuration
# Copy this file to .env and configure for your environment

# =============================================================================
# REQUIRED ENVIRONMENT VARIABLES
# =============================================================================

# Database Configuration
DB_DSN=postgresql://heimdall_user:your_password@localhost:5432/heimdall

# Cerbos Authorization Service
CERBOS_BASE_URL=http://localhost:3593
CERBOS_ADMIN_USER=admin
CERBOS_ADMIN_PASSWORD=your_cerbos_admin_password

# Keycloak Authentication
KEYCLOAK_JWKS_URL=https://keycloak.example.com/realms/your-realm/protocol/openid-connect/certs
KEYCLOAK_CLIENT_ID=heimdall-admin

# JWT Configuration
JWT_ALGORITHM=RS256
JWT_AUDIENCE=account

# Static API Token (for service-to-service communication)
STATIC_API_TOKEN=your-secure-static-api-token-here

# =============================================================================
# OPTIONAL ENVIRONMENT VARIABLES (with defaults)
# =============================================================================

# Keycloak Role Configuration
KEYCLOAK_ADMIN_ROLE=heimdall-admin          # Client role that grants superadmin privileges (default: heimdall-admin)

# Redis Caching (defaults to redis://redis:6379/0)
REDIS_URL=redis://localhost:6379/0

# Cache TTL Settings (in seconds)
REDIS_MAPPING_TTL=60                    # Mapping resolution cache TTL (default: 60)
REDIS_USER_ROLES_TTL=30                 # User roles cache TTL (default: 30)
REDIS_JWKS_TTL=300                      # JWKS cache TTL (default: 300)

# Background Task Configuration (in seconds)
RECONCILE_INTERVAL_SECONDS=300          # Cerbos policy reconciliation interval (default: 300)
SYNC_RETRY_INTERVAL_SECONDS=60          # Failed sync retry interval (default: 60)

# Server Configuration
HOST=0.0.0.0                            # Server bind address (default: 0.0.0.0)
PORT=8080                               # Server port (default: 8080)

# OpenTelemetry Configuration (optional - only set if you want tracing)
OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4317          # Enables tracing when set (default: disabled)
OTEL_SERVICE_NAME=heimdall-admin-service                   # Service name for traces (default: heimdall-admin-service)
OTEL_RESOURCE_ATTRIBUTES=service.version=1.0.0,deployment.environment=development  # Additional trace attributes (default: empty)

# =============================================================================
# DEVELOPMENT ENVIRONMENT EXAMPLES
# =============================================================================

# For local development with docker-compose:
# DB_DSN=postgresql://heimdall:heimdall@localhost:5432/heimdall
# CERBOS_BASE_URL=http://localhost:3593
# CERBOS_ADMIN_USER=admin
# CERBOS_ADMIN_PASSWORD=password
# KEYCLOAK_JWKS_URL=https://your-keycloak.com/realms/your-realm/protocol/openid-connect/certs
# STATIC_API_TOKEN=dev-static-token-123

# Optional: Enable tracing for development
# OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4317

# =============================================================================
# PRODUCTION ENVIRONMENT NOTES
# =============================================================================

# For production:
# 1. Use strong, randomly generated passwords and tokens
# 2. Use proper SSL/TLS URLs for all external services
# 3. Consider using container orchestration secrets instead of .env files
# 4. Set appropriate cache TTL values based on your performance requirements
# 5. Configure OTEL_RESOURCE_ATTRIBUTES with proper environment and version info

# Security reminders:
# - Never commit .env files with real credentials to version control
# - Use environment-specific values for each deployment
# - Rotate tokens and passwords regularly
# - Use least-privilege principles for database and service accounts